2025-10-21 10:23:24,756 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-21 10:23:25,864 | INFO | src.extract | Fetched 100 records
2025-10-21 10:23:25,910 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-21 10:23:25,917 | WARNING | __main__ | Data Quality issues: ['Invalid priority values found in fact_ticket']
2025-10-21 10:23:26,077 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-21 10:23:26,206 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-21 10:23:26,366 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-21 10:23:26,558 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-21 10:30:31,899 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-21 10:30:32,999 | INFO | src.extract | Fetched 100 records
2025-10-21 10:30:33,048 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-21 10:30:33,059 | WARNING | __main__ | Data Quality issues: ['Invalid priority values found in fact_ticket']
2025-10-21 10:30:33,208 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-21 10:30:33,323 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-21 10:30:33,455 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-21 10:30:33,610 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-21 10:35:10,056 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-21 10:35:11,104 | INFO | src.extract | Fetched 100 records
2025-10-21 10:35:11,156 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-21 10:35:11,162 | WARNING | __main__ | Data Quality issues: ['Invalid priority values found in fact_ticket']
2025-10-21 10:35:11,314 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-21 10:35:11,425 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-21 10:35:11,543 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-21 10:35:11,693 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-21 10:40:30,685 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-21 10:40:31,970 | INFO | src.extract | Fetched 100 records
2025-10-21 10:40:32,033 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-21 10:40:32,048 | WARNING | __main__ | Data Quality issues: ['Invalid priority values found in fact_ticket']
2025-10-21 10:40:32,208 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-21 10:40:32,292 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-21 10:40:32,371 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-21 10:40:32,484 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-21 10:47:42,394 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-21 10:47:43,458 | INFO | src.extract | Fetched 100 records
2025-10-21 10:47:43,499 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-21 10:47:43,660 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-21 10:47:43,772 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-21 10:47:43,894 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-21 10:47:44,028 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-21 11:36:35,031 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-21 11:36:35,171 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-21 11:36:36,018 | INFO | src.extract | Fetched 100 records
2025-10-21 11:36:36,020 | INFO | __main__ | Fetched 100 raw records
2025-10-21 11:36:36,034 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-21 11:36:36,042 | INFO | __main__ | DQ Checks: None
2025-10-21 11:36:36,309 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-21 11:36:36,413 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-21 11:36:36,507 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-21 11:36:36,698 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-21 11:39:50,815 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-21 11:39:50,920 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-21 11:39:51,672 | INFO | src.extract | Fetched 100 records
2025-10-21 11:39:51,675 | INFO | __main__ | Fetched 100 raw records
2025-10-21 11:39:51,693 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-21 11:39:51,698 | INFO | __main__ | DQ Checks: None
2025-10-21 11:39:51,790 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-21 11:39:51,885 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-21 11:39:51,963 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-21 11:39:52,075 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-21 11:39:52,137 | INFO | __main__ | ETL run complete with status=SUCCESS
2025-10-21 15:00:06,529 | INFO | __main__ | ===== Starting ETL Run ([AUTO-CRON]) =====
2025-10-21 15:00:06,716 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-21 15:00:07,980 | INFO | src.extract | Fetched 100 records
2025-10-21 15:00:07,985 | INFO | __main__ | Fetched 100 raw records
2025-10-21 15:00:08,030 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-21 15:00:08,045 | INFO | __main__ | DQ Checks: None
2025-10-21 15:00:08,260 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-21 15:00:08,349 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-21 15:00:08,421 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-21 15:00:08,521 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-21 15:00:08,570 | INFO | __main__ | ETL run complete with status=SUCCESS
2025-10-22 09:00:15,907 | INFO | __main__ | ===== Starting ETL Run ([AUTO-CRON]) =====
2025-10-22 09:00:16,772 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-22 09:00:18,552 | INFO | src.extract | Fetched 100 records
2025-10-22 09:00:18,673 | INFO | __main__ | Fetched 100 raw records
2025-10-22 09:00:18,934 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-22 09:00:19,008 | INFO | __main__ | DQ Checks: None
2025-10-22 09:00:19,554 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/c/Users/ACER/Documents/service-desk-etl/src/main.py", line 44, in run
    upsert_frame(tables["dim_user"], "dim_user", ["user_id"])
  File "/mnt/c/Users/ACER/Documents/service-desk-etl/src/load.py", line 14, in upsert_frame
    with engine.begin() as conn:
  File "/usr/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/root123/.local/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-22 09:00:55,199 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-22 09:01:00,228 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-22 09:01:00,957 | INFO | src.extract | Fetched 100 records
2025-10-22 09:01:01,011 | INFO | __main__ | Fetched 100 raw records
2025-10-22 09:01:01,094 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-22 09:01:01,110 | INFO | __main__ | DQ Checks: None
2025-10-22 09:01:05,230 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 44, in run
    upsert_frame(tables["dim_user"], "dim_user", ["user_id"])
  File "C:\Users\ACER\Documents\service-desk-etl\src\load.py", line 14, in upsert_frame
    with engine.begin() as conn:
  File "C:\Users\ACER\AppData\Local\Programs\Python\Python310\lib\contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\future\engine.py", line 385, in begin
    with self.connect() as conn:
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\future\engine.py", line 412, in connect
    return super(Engine, self).connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-10-22 10:06:49,438 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-22 10:06:49,720 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-22 10:06:50,113 | INFO | src.extract | Fetched 100 records
2025-10-22 10:06:50,113 | INFO | __main__ | Fetched 100 raw records
2025-10-22 10:06:50,174 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-22 10:06:50,183 | INFO | __main__ | DQ Checks: None
2025-10-22 10:06:54,298 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 44, in run
    upsert_frame(tables["dim_user"], "dim_user", ["user_id"])
  File "C:\Users\ACER\Documents\service-desk-etl\src\load.py", line 14, in upsert_frame
    with engine.begin() as conn:
  File "C:\Users\ACER\AppData\Local\Programs\Python\Python310\lib\contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\future\engine.py", line 385, in begin
    with self.connect() as conn:
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\future\engine.py", line 412, in connect
    return super(Engine, self).connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-10-22 10:09:42,982 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-22 10:09:43,116 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-22 10:09:43,625 | INFO | src.extract | Fetched 100 records
2025-10-22 10:09:43,627 | INFO | __main__ | Fetched 100 raw records
2025-10-22 10:09:43,680 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-22 10:09:43,689 | INFO | __main__ | DQ Checks: None
2025-10-22 10:09:47,782 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 44, in run
    upsert_frame(tables["dim_user"], "dim_user", ["user_id"])
  File "C:\Users\ACER\Documents\service-desk-etl\src\load.py", line 14, in upsert_frame
    with engine.begin() as conn:
  File "C:\Users\ACER\AppData\Local\Programs\Python\Python310\lib\contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\future\engine.py", line 385, in begin
    with self.connect() as conn:
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\future\engine.py", line 412, in connect
    return super(Engine, self).connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-10-22 10:11:07,702 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-22 10:11:07,824 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-22 10:11:08,109 | INFO | src.extract | Fetched 100 records
2025-10-22 10:11:08,113 | INFO | __main__ | Fetched 100 raw records
2025-10-22 10:11:08,134 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-22 10:11:08,143 | INFO | __main__ | DQ Checks: None
2025-10-22 10:11:08,615 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 44, in run
    upsert_frame(tables["dim_user"], "dim_user", ["user_id"])
  File "C:\Users\ACER\Documents\service-desk-etl\src\load.py", line 18, in upsert_frame
    df.head(0).to_sql(tmp.split('.')[-1], conn, schema="dw", if_exists="replace", index=False)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\core\generic.py", line 3109, in to_sql
    return sql.to_sql(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\io\sql.py", line 844, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\io\sql.py", line 2840, in to_sql
    table.create()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\io\sql.py", line 986, in create
    if self.exists():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\io\sql.py", line 972, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\io\sql.py", line 2855, in has_table
    return len(self.execute(query, [name]).fetchall()) > 0
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\io\sql.py", line 2662, in execute
    cur = self.con.cursor()
AttributeError: 'Connection' object has no attribute 'cursor'
2025-10-22 10:11:08,690 | INFO | __main__ | ETL run complete with status=FAILED
2025-10-22 11:08:34,091 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-22 11:08:37,420 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-22 11:08:38,603 | INFO | src.extract | Fetched 100 records
2025-10-22 11:08:38,607 | INFO | __main__ | Fetched 100 raw records
2025-10-22 11:08:38,630 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-22 11:08:38,636 | INFO | __main__ | DQ Checks: None
2025-10-22 11:08:39,059 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-22 11:08:39,152 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-22 11:08:39,244 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-22 11:08:39,383 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-22 11:08:39,437 | INFO | __main__ | ETL run complete with status=SUCCESS
2025-10-22 14:56:57,519 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-22 14:57:00,428 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-22 14:57:00,980 | INFO | src.extract | Fetched 100 records
2025-10-22 14:57:00,986 | INFO | __main__ | Fetched 100 raw records
2025-10-22 14:57:01,013 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-22 14:57:01,023 | INFO | __main__ | DQ Checks: None
2025-10-22 14:57:01,465 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-22 14:57:01,586 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-22 14:57:01,706 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-22 14:57:01,854 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-22 14:57:01,923 | INFO | __main__ | ETL run complete with status=SUCCESS
2025-10-24 08:52:13,258 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-24 08:52:13,796 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-24 08:52:14,167 | INFO | src.extract | Fetched 100 records
2025-10-24 08:52:14,169 | INFO | __main__ | Fetched 100 raw records
2025-10-24 08:52:14,208 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-24 08:52:14,215 | INFO | __main__ | DQ Checks: None
2025-10-24 08:52:18,672 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 44, in run
    upsert_frame(tables["dim_user"], "dim_user", ["user_id"])
  File "C:\Users\ACER\Documents\service-desk-etl\src\load.py", line 14, in upsert_frame
    with engine.begin() as conn:
  File "C:\Users\ACER\AppData\Local\Programs\Python\Python310\lib\contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3241, in begin
    with self.connect() as conn:
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-24 08:57:59,594 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-24 08:57:59,755 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-24 08:58:00,209 | INFO | src.extract | Fetched 100 records
2025-10-24 08:58:00,214 | INFO | __main__ | Fetched 100 raw records
2025-10-24 08:58:00,247 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-24 08:58:00,261 | INFO | __main__ | DQ Checks: None
2025-10-24 08:58:00,562 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-24 08:58:00,684 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-24 08:58:00,808 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-24 08:58:01,015 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-24 08:58:01,147 | INFO | __main__ | ETL run complete with status=SUCCESS
2025-10-24 09:17:07,904 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-24 09:17:08,213 | INFO | src.extract | Fetched 100 records
2025-10-24 09:17:08,236 | INFO | __main__ | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-24 09:17:26,768 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-24 09:17:27,096 | INFO | src.extract | Fetched 100 records
2025-10-24 09:17:27,153 | INFO | __main__ | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-24 14:09:59,929 | INFO | __main__ | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-24 14:10:00,430 | INFO | __main__ | Fetched 100 records
2025-10-24 14:15:08,173 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-24 14:15:08,808 | INFO | src.extract | Fetched 100 records
2025-10-24 14:15:08,947 | INFO | __main__ | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-24 14:30:53,000 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-24 14:30:53,572 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-24 14:30:53,896 | INFO | src.extract | Fetched 100 records
2025-10-24 14:30:53,900 | INFO | __main__ | Fetched 100 raw records
2025-10-24 14:30:53,923 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-24 14:30:53,948 | INFO | __main__ | DQ Checks: None
2025-10-24 14:30:58,224 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 44, in run
    upsert_frame(tables["dim_user"], "dim_user", ["user_id"])
  File "C:\Users\ACER\Documents\service-desk-etl\src\load.py", line 14, in upsert_frame
    with engine.begin() as conn:
  File "C:\Users\ACER\AppData\Local\Programs\Python\Python310\lib\contextlib.py", line 135, in __enter__
    return next(self.gen)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3241, in begin
    with self.connect() as conn:
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3277, in connect
    return self._connection_cls(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 3301, in raw_connection
    return self.pool.connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 711, in checkout
    rec = pool._do_get()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\impl.py", line 175, in _do_get
    return self._create_connection()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 673, in __init__
    self.__connect()
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 899, in __connect
    with util.safe_reraise():
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\pool\base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-24 14:31:21,077 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-24 14:31:21,253 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-24 14:31:21,605 | INFO | src.extract | Fetched 100 records
2025-10-24 14:31:21,609 | INFO | __main__ | Fetched 100 raw records
2025-10-24 14:31:21,637 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-24 14:31:21,646 | INFO | __main__ | DQ Checks: None
2025-10-24 14:31:21,903 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-24 14:31:22,002 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-24 14:31:22,100 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-24 14:31:22,278 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-24 14:31:22,357 | INFO | __main__ | ETL run complete with status=SUCCESS
2025-10-24 16:19:29,932 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-24 16:19:30,506 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-24 16:19:32,109 | INFO | src.extract | Fetched 100 records
2025-10-24 16:19:32,113 | INFO | __main__ | Fetched 100 raw records
2025-10-24 16:19:32,179 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-24 16:19:32,190 | INFO | __main__ | DQ Checks: None
2025-10-24 16:19:32,516 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-24 16:19:32,621 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-24 16:19:32,747 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-24 16:19:33,002 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-24 16:19:33,097 | INFO | __main__ | ETL run complete with status=SUCCESS
2025-10-27 09:09:49,995 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-27 09:09:50,692 | INFO | src.extract | Requesting source API: https://jsonplaceholder.typicode.com/posts
2025-10-27 09:09:51,195 | INFO | src.extract | Fetched 100 records
2025-10-27 09:09:51,195 | INFO | __main__ | Fetched 100 raw records
2025-10-27 09:09:51,237 | INFO | src.transform | dim_user=10, dim_category=1, dim_sla=1, fact_ticket=100
2025-10-27 09:09:51,246 | INFO | __main__ | DQ Checks: None
2025-10-27 09:09:51,512 | INFO | src.load | Upserted 10 rows into dw.dim_user
2025-10-27 09:09:51,652 | INFO | src.load | Upserted 1 rows into dw.dim_category
2025-10-27 09:09:51,830 | INFO | src.load | Upserted 1 rows into dw.dim_sla
2025-10-27 09:09:52,307 | INFO | src.load | Upserted 100 rows into dw.fact_ticket
2025-10-27 09:09:52,433 | INFO | __main__ | ETL run complete with status=SUCCESS
2025-10-27 13:38:38,692 | INFO | __main__ | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 13:38:39,464 | INFO | __main__ | Fetched 987 records
2025-10-27 13:43:01,311 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 13:43:01,963 | INFO | src.extract | Fetched 987 records
2025-10-27 13:49:36,398 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 13:49:36,925 | INFO | src.extract | Fetched 987 records
2025-10-27 13:49:36,961 | INFO | __main__ |  Cleaned 987 review records from MRTJ API
2025-10-27 14:40:13,708 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-27 14:40:14,471 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 14:40:15,549 | INFO | src.extract | Fetched 987 records
2025-10-27 14:40:15,554 | INFO | __main__ | Fetched 987 raw records
2025-10-27 14:40:15,596 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 14:40:15,598 | INFO | __main__ | DQ Checks: None
2025-10-27 14:40:15,614 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'fact_ticket'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 40, in run
    row_count = len(tables["fact_ticket"])
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\core\frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'fact_ticket'
2025-10-27 14:40:15,959 | INFO | __main__ | ETL run complete with status=FAILED
2025-10-27 14:53:31,219 | INFO | __main__ | ===== Starting ETL Run (MANUAL_FORCE) =====
2025-10-27 14:53:31,422 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 14:53:32,179 | INFO | src.extract | Fetched 987 records
2025-10-27 14:53:32,201 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-27 14:53:32,229 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 14:53:32,232 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-27 14:53:32,234 | INFO | __main__ | DQ Checks: None
2025-10-27 14:53:33,219 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "dw.fact_reviews" does not exist
LINE 1: INSERT INTO dw.fact_reviews (review_id, username, rating, re...
                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 46, in run
    upsert_frame(df_reviews, "fact_reviews", ["review_id"])
  File "C:\Users\ACER\Documents\service-desk-etl\src\load.py", line 38, in upsert_frame
    conn.execute(text(merge_sql))
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "dw.fact_reviews" does not exist
LINE 1: INSERT INTO dw.fact_reviews (review_id, username, rating, re...
                    ^

[SQL: INSERT INTO dw.fact_reviews (review_id, username, rating, review_text, date, sentiment)
SELECT review_id, username, rating, review_text, date, sentiment FROM dw.tmp_fact_reviews
ON CONFLICT (review_id) DO UPDATE SET username=EXCLUDED.username, rating=EXCLUDED.rating, review_text=EXCLUDED.review_text, date=EXCLUDED.date, sentiment=EXCLUDED.sentiment;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-27 14:53:33,456 | INFO | __main__ | ETL run complete with status=FAILED
2025-10-27 14:58:14,063 | INFO | __main__ | ===== Starting ETL Run (MANUAL_FORCE) =====
2025-10-27 14:58:14,338 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 14:58:15,023 | INFO | src.extract | Fetched 987 records
2025-10-27 14:58:15,027 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-27 14:58:15,048 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 14:58:15,048 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-27 14:58:15,048 | INFO | __main__ | DQ Checks: None
2025-10-27 14:58:15,337 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "dw.fact_reviews" does not exist
LINE 1: INSERT INTO dw.fact_reviews (review_id, username, rating, re...
                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 49, in run
    upsert_frame(df_reviews, "fact_reviews", ["review_id"])
  File "C:\Users\ACER\Documents\service-desk-etl\src\load.py", line 38, in upsert_frame
    conn.execute(text(merge_sql))
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "dw.fact_reviews" does not exist
LINE 1: INSERT INTO dw.fact_reviews (review_id, username, rating, re...
                    ^

[SQL: INSERT INTO dw.fact_reviews (review_id, username, rating, review_text, date, sentiment)
SELECT review_id, username, rating, review_text, date, sentiment FROM dw.tmp_fact_reviews
ON CONFLICT (review_id) DO UPDATE SET username=EXCLUDED.username, rating=EXCLUDED.rating, review_text=EXCLUDED.review_text, date=EXCLUDED.date, sentiment=EXCLUDED.sentiment;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-27 14:58:15,427 | INFO | __main__ | ETL run complete with status=FAILED
2025-10-27 15:08:41,908 | INFO | __main__ | ===== Starting ETL Run (MANUAL_FORCE) =====
2025-10-27 15:08:42,086 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 15:08:42,734 | INFO | src.extract | Fetched 987 records
2025-10-27 15:08:42,738 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-27 15:08:42,762 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 15:08:42,769 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-27 15:08:42,771 | INFO | __main__ | DQ Checks: None
2025-10-27 15:08:43,101 | ERROR | __main__ | ETL Failed
Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "dw.fact_reviews" does not exist
LINE 1: INSERT INTO dw.fact_reviews (review_id, username, rating, re...
                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ACER\Documents\service-desk-etl\src\main.py", line 49, in run
    upsert_frame(df_reviews, "fact_reviews", ["review_id"])
  File "C:\Users\ACER\Documents\service-desk-etl\src\load.py", line 38, in upsert_frame
    conn.execute(text(merge_sql))
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\ACER\Documents\service-desk-etl\venv\lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "dw.fact_reviews" does not exist
LINE 1: INSERT INTO dw.fact_reviews (review_id, username, rating, re...
                    ^

[SQL: INSERT INTO dw.fact_reviews (review_id, username, rating, review_text, date, sentiment)
SELECT review_id, username, rating, review_text, date, sentiment FROM dw.tmp_fact_reviews
ON CONFLICT (review_id) DO UPDATE SET username=EXCLUDED.username, rating=EXCLUDED.rating, review_text=EXCLUDED.review_text, date=EXCLUDED.date, sentiment=EXCLUDED.sentiment;]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-10-27 15:08:43,325 | INFO | __main__ | ETL run complete with status=FAILED
2025-10-27 15:15:58,175 | INFO | __main__ | ===== Starting ETL Run (MANUAL_FORCE) =====
2025-10-27 15:15:58,388 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 15:15:58,951 | INFO | src.extract | Fetched 987 records
2025-10-27 15:15:58,957 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-27 15:15:58,979 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 15:15:59,024 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-27 15:15:59,034 | INFO | __main__ | DQ Checks: None
2025-10-27 15:15:59,475 | INFO | src.load | Upserted 987 rows into dw.fact_reviews
2025-10-27 15:15:59,589 | INFO | __main__ | DB=servicedesk_dw, user=etl_user, host=172.18.0.3/32, port=5432, schema=public, fact_reviews=dw.fact_reviews
2025-10-27 15:23:51,480 | INFO | __main__ | ===== Starting ETL Run (MANUAL_FORCE) =====
2025-10-27 15:23:51,652 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 15:24:00,647 | INFO | src.extract | Fetched 987 records
2025-10-27 15:24:00,653 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-27 15:24:00,677 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 15:24:00,688 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-27 15:24:00,691 | INFO | __main__ | DQ Checks: None
2025-10-27 15:24:01,082 | INFO | src.load | Upserted 987 rows into dw.fact_reviews
2025-10-27 15:24:01,178 | INFO | __main__ | DB=servicedesk_dw, user=etl_user, host=172.18.0.3/32, port=5432, schema=public, fact_reviews=dw.fact_reviews
2025-10-27 15:28:27,426 | INFO | __main__ | ===== Starting ETL Run (MANUAL_FORCE) =====
2025-10-27 15:28:27,705 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 15:28:28,349 | INFO | src.extract | Fetched 987 records
2025-10-27 15:28:28,356 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-27 15:28:28,383 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 15:28:28,383 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-27 15:28:28,385 | INFO | __main__ | DQ Checks: None
2025-10-27 15:28:29,017 | INFO | src.load | Upserted 987 rows into dw.fact_reviews
2025-10-27 15:28:29,288 | INFO | __main__ | DB=servicedesk_dw, user=etl_user, host=172.18.0.3/32, port=5432, schema=public, fact_reviews=dw.fact_reviews
2025-10-27 15:30:29,208 | INFO | __main__ | ===== Starting ETL Run (MANUAL_FORCE) =====
2025-10-27 15:30:29,393 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 15:30:30,014 | INFO | src.extract | Fetched 987 records
2025-10-27 15:30:30,019 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-27 15:30:30,047 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 15:30:30,049 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-27 15:30:30,057 | INFO | __main__ | DQ Checks: None
2025-10-27 15:30:30,359 | INFO | src.load | Upserted 987 rows into dw.fact_reviews
2025-10-27 15:30:30,444 | INFO | __main__ | DB=servicedesk_dw, user=etl_user, host=172.18.0.3/32, port=5432, schema=public, fact_reviews=dw.fact_reviews
2025-10-27 15:32:13,560 | INFO | __main__ | ===== Starting ETL Run (MANUAL_FORCE) =====
2025-10-27 15:32:13,727 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 15:32:14,765 | INFO | src.extract | Fetched 987 records
2025-10-27 15:32:14,769 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-27 15:32:14,792 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 15:32:14,802 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-27 15:32:14,807 | INFO | __main__ | DQ Checks: None
2025-10-27 15:32:15,185 | INFO | src.load |  Upserted 987 rows into dw.fact_reviews
2025-10-27 15:32:15,282 | INFO | __main__ | DB=servicedesk_dw, user=etl_user, host=172.18.0.3/32, port=5432, schema=public, fact_reviews=dw.fact_reviews
2025-10-27 15:42:26,700 | INFO | __main__ | ===== Starting ETL Run (MANUAL_FORCE) =====
2025-10-27 15:42:27,014 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-27 15:42:29,363 | INFO | src.extract | Fetched 987 records
2025-10-27 15:42:29,366 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-27 15:42:29,387 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-27 15:42:29,389 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-27 15:42:29,393 | INFO | __main__ | DQ Checks: None
2025-10-27 15:42:29,733 | INFO | src.load |  Upserted 987 rows into dw.fact_reviews
2025-10-27 15:42:29,913 | INFO | __main__ |  ETL run complete with status=SUCCESS
2025-10-28 08:42:24,142 | INFO | __main__ | ===== Starting ETL Run (MANUAL) =====
2025-10-28 08:42:25,005 | INFO | src.extract | Requesting source API: https://mrtj-api-production.up.railway.app//
2025-10-28 08:42:25,696 | INFO | src.extract | Fetched 987 records
2025-10-28 08:42:25,701 | INFO | __main__ | Fetched 987 raw review records from MRTJ API
2025-10-28 08:42:25,803 | INFO | src.transform |  Cleaned 987 review records from MRTJ API
2025-10-28 08:42:25,803 | INFO | __main__ | Transformed 987 cleaned review records
2025-10-28 08:42:25,806 | INFO | __main__ | DQ Checks: None
2025-10-28 08:42:26,496 | INFO | src.load |  Upserted 987 rows into dw.fact_reviews
2025-10-28 08:42:26,506 | INFO | __main__ |  Loaded 987 reviews into dw.fact_reviews
2025-10-28 08:42:26,739 | INFO | __main__ | ETL run complete with status=SUCCESS
